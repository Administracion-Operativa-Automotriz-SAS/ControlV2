<?php/** * Clase para interfase de documentos HELISA * * @version $Id$ * @copyright 2009 ARTURO QUINTERO RODRIGUEZ  administracion@intercolombia.net */class Interfase_documento{	var $Tipo_comprobante='CC';	var $Numero_documento='0';	var $Fecha_documento='00/00/0000';  // dd/mm/aaaa	var $Cuenta_contable='00000000';  // 8 posiciones	var $Descripcion='                                                  '; // 50 espacios	var $Centro_costos='0000';	var $Valor='000000000000000'; // 13 enteros 2 decimales	var $Afectacion='D'; // D | C	var $Nit='0000000000000';	var $Cheque='0';	var $Base='0';	var $Fin_de_linea="\r\n";	function genera()	{		$this->Descripcion=$this->prepara_cadena($this->Descripcion,50);		$this->Valor=$this->prepara_valor($this->Valor,13,2);		//-----------------------------------------------------------------------------------------------------------------------		$Resultado=$this->Tipo_comprobante.','.$this->Numero_documento.','.$this->Fecha_documento;		$Resultado.=','.$this->Cuenta_contable.','.$this->Descripcion.','.$this->Centro_costos;		$Resultado.=','.$this->Valor.','.$this->Afectacion.','.$this->Nit.','.$this->Cheque.','.$this->Base;		$Resultado.=$this->Fin_de_linea;		return $Resultado;	}	function prepara_valor($Valor=0,$Enteros=13,$Decimales=0)	{		$Entero=intval($Valor);		$Decimal=round($Valor-$Entero,$Decimales);		$Cadena1=strval($Entero);		$Resultado=str_pad($Cadena1,$Enteros,' ',STR_PAD_LEFT);		if($Decimales)		{			$Cadena2=strval($Decimal);			$Resultado.='.'.str_pad(substr($Cadena2,strpos($Cadena2,'.')+1,$Decimales),$Decimales,'0',STR_PAD_RIGHT);		}		return $Resultado;	}	function prepara_cadena($Cadena,$Longitud=50)	{		return str_pad(substr($Cadena,0,$Longitud),$Longitud," ",STR_PAD_RIGHT);	}}?>